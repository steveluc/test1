(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const t of s)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const t={};return s.integrity&&(t.integrity=s.integrity),s.referrerPolicy&&(t.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?t.credentials="include":s.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function e(s){if(s.ep)return;s.ep=!0;const t=n(s);fetch(s.href,t)}})();let E=50,C=8,R=6,g=[],v=null,L=[],P=null,y=null,$=0,k=-1;function N(o,l){y=o.cloneNode(!0),y.classList.add("drag-ghost"),y.style.width=o.offsetWidth+"px",y.style.height=o.offsetHeight+"px",y.style.left=l.clientX+"px",y.style.top=l.clientY+"px";const n=window.getComputedStyle(o).transform;n&&n!=="none"&&(y.style.transform=n+" translate(-50%, -50%)"),document.body.appendChild(y)}function W(o){y&&(y.style.left=o.clientX+"px",y.style.top=o.clientY+"px")}function D(){y&&(y.remove(),y=null)}function M(o){const n=window.innerHeight>window.innerWidth?o:S(o);g[n].rotation||(g[n].rotation=0),g[n].rotation=(g[n].rotation+90)%360,q()}function B(){const o=window.innerHeight>window.innerWidth,l=o?6:8,n=o?8:6;let e,s;o?(e=window.innerHeight-200,s=window.innerWidth-40):(e=window.innerHeight-30,s=window.innerWidth-320-40);const t=Math.floor((e-20)/n),i=Math.floor((s-20)/l);return Math.max(30,Math.min(t,i,100))}function b(){const o=Math.floor(Math.random()*360),l=60+Math.floor(Math.random()*30),n=60+Math.floor(Math.random()*20);return`hsl(${o}, ${l}%, ${n}%)`}function j(){const o=["solid","horizontal","vertical","diagonal","checkerboard","quartersquare"],l=o[Math.floor(Math.random()*o.length)];if(l==="solid")return{type:"solid",colors:[b()],rotation:0};if(l==="horizontal"||l==="vertical"||l==="diagonal"){const n=[];for(let e=0;e<5;e++)n.push(b());return{type:l,colors:n,rotation:0}}else{if(l==="checkerboard")return{type:"checkerboard",colors:[b(),b()],rotation:0};if(l==="quartersquare")return{type:"quartersquare",colors:[b(),b(),b(),b()],rotation:0}}return{type:"solid",colors:[b()],rotation:0}}function H(){g=[];for(let o=0;o<48;o++)g.push(j())}function O(o){if(o.type==="solid")return o.colors[0];if(o.type==="horizontal"){const n=[];for(let e=0;e<5;e++){const s=e*20,t=(e+1)*20;n.push(`${o.colors[e]} ${s}%`),n.push(`${o.colors[e]} ${t}%`)}return`linear-gradient(to bottom, ${n.join(", ")})`}else if(o.type==="vertical"){const n=[];for(let e=0;e<5;e++){const s=e*20,t=(e+1)*20;n.push(`${o.colors[e]} ${s}%`),n.push(`${o.colors[e]} ${t}%`)}return`linear-gradient(to right, ${n.join(", ")})`}else if(o.type==="diagonal"){const n=[];for(let e=0;e<5;e++){const s=e*20,t=(e+1)*20;n.push(`${o.colors[e]} ${s}%`),n.push(`${o.colors[e]} ${t}%`)}return`linear-gradient(45deg, ${n.join(", ")})`}else if(o.type==="checkerboard"){const l=o.colors[0].replace("#","%23"),n=o.colors[1].replace("#","%23");let e="";for(let s=0;s<4;s++)for(let t=0;t<4;t++){const i=(s+t)%2===0?l:n;e+=`<rect x='${t*25}' y='${s*25}' width='25' height='25' fill='${i}'/>`}return`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>${e}</svg>")`}else if(o.type==="quartersquare"){const l=o.colors[0].replace("#","%23"),n=o.colors[1].replace("#","%23"),e=o.colors[2].replace("#","%23"),s=o.colors[3].replace("#","%23");return`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><polygon points='0,0 100,0 50,50' fill='${l}'/><polygon points='100,0 100,100 50,50' fill='${n}'/><polygon points='100,100 0,100 50,50' fill='${e}'/><polygon points='0,100 0,0 50,50' fill='${s}'/></svg>")`}return""}function z(){const l=document.getElementById("designerPatternType").value,n=document.getElementById("colorStripePicker");n.innerHTML="";let e=1,s=["#ff6b9d"];l==="solid"?(e=1,s=["#ff6b9d"]):l==="horizontal"||l==="vertical"||l==="diagonal"?(e=5,s=["#ff6b9d","#764ba2","#667eea","#f093fb","#4facfe"]):l==="checkerboard"?(e=2,s=["#ff6b9d","#667eea"]):l==="quartersquare"&&(e=4,s=["#ff6b9d","#764ba2","#667eea","#f093fb"]);for(let t=0;t<e;t++){const i=document.createElement("input");i.type="color",i.value=s[t],n.appendChild(i)}}function A(){const l=document.getElementById("designerPatternType").value,n=document.querySelectorAll('#colorStripePicker input[type="color"]'),e=Array.from(n).map(t=>t.value),s={type:l,colors:e,rotation:0};L.push(s),I()}function I(){const o=document.getElementById("libraryItems");if(o.innerHTML="",L.length===0){o.innerHTML='<p style="color: #999; font-style: italic;">No patterns yet. Design one above to get started!</p>';return}L.forEach((l,n)=>{const e=document.createElement("div");e.className="library-item",e.draggable=!0;const s=O(l);l.type==="solid"?(e.style.backgroundColor=s,e.style.backgroundImage="none"):(e.style.backgroundImage=s,e.style.backgroundColor="transparent",e.style.backgroundRepeat="no-repeat"),e.addEventListener("dragstart",()=>{P=n,e.classList.add("dragging")}),e.addEventListener("dragend",()=>{e.classList.remove("dragging"),P=null}),e.addEventListener("touchstart",i=>{P=n,v=null,e.classList.add("dragging"),N(e,i.touches[0]),i.stopPropagation()}),e.addEventListener("touchmove",i=>{i.preventDefault();const u=i.touches[0];W(u);const a=document.elementFromPoint(u.clientX,u.clientY);document.querySelectorAll(".quilt-square.drag-over").forEach(r=>{r.classList.remove("drag-over")}),a&&a.classList.contains("quilt-square")&&a.classList.add("drag-over")}),e.addEventListener("touchend",i=>{i.preventDefault(),e.classList.remove("dragging"),D();const u=i.changedTouches[0],a=document.elementFromPoint(u.clientX,u.clientY);if(document.querySelectorAll(".quilt-square.drag-over").forEach(r=>{r.classList.remove("drag-over")}),a&&a.classList.contains("quilt-square")){const r=document.getElementById("quilt"),w=Array.from(r.children).indexOf(a),f=window.innerHeight>window.innerWidth;if(w!==-1){const p=f?w:S(w);g[p]=JSON.parse(JSON.stringify(L[n]));const m=g[p],d=O(m),c=a;m.type==="solid"?(c.style.backgroundColor=d,c.style.backgroundImage="none"):(c.style.backgroundImage=d,c.style.backgroundColor="transparent",c.style.backgroundRepeat="no-repeat"),c.style.transform=`rotate(${m.rotation||0}deg)`}}P=null});const t=document.createElement("button");t.className="delete-btn",t.textContent="Ã—",t.onclick=i=>{i.stopPropagation(),L.splice(n,1),I()},e.appendChild(t),o.appendChild(e)})}function J(){const o=window.innerHeight>window.innerWidth,l=o?6:8,n=o?8:6,e=100,s=document.createElement("canvas");s.width=l*e,s.height=n*e;const t=s.getContext("2d");for(let i=0;i<n*l;i++){const u=Math.floor(i/l),r=i%l*e,w=u*e,f=o?i:S(i),p=g[f],m=p.rotation||0;if(t.save(),m!==0?(t.translate(r+e/2,w+e/2),t.rotate(m*Math.PI/180),t.translate(-e/2,-e/2)):t.translate(r,w),p.type==="solid")t.fillStyle=p.colors[0],t.fillRect(0,0,e,e),t.restore();else if(p.type==="horizontal"){const d=e/5;for(let c=0;c<5;c++)t.fillStyle=p.colors[c],t.fillRect(0,c*d,e,d);t.restore()}else if(p.type==="vertical"){const d=e/5;for(let c=0;c<5;c++)t.fillStyle=p.colors[c],t.fillRect(c*d,0,d,e);t.restore()}else if(p.type==="diagonal"){t.beginPath(),t.rect(0,0,e,e),t.clip(),t.translate(e/2,e/2),t.rotate(-45*Math.PI/180);const d=e*Math.sqrt(2),c=d/5;for(let h=0;h<5;h++)t.fillStyle=p.colors[h],t.fillRect(-d/2+h*c,-d/2,c,d);t.restore()}else if(p.type==="checkerboard"){const d=e/4;for(let c=0;c<4;c++)for(let h=0;h<4;h++){const T=(c+h)%2;t.fillStyle=p.colors[T],t.fillRect(h*d,c*d,d,d)}t.restore()}else if(p.type==="quartersquare"){const d=e/2,c=e/2;t.fillStyle=p.colors[0],t.beginPath(),t.moveTo(0,0),t.lineTo(e,0),t.lineTo(d,c),t.closePath(),t.fill(),t.fillStyle=p.colors[1],t.beginPath(),t.moveTo(e,0),t.lineTo(e,e),t.lineTo(d,c),t.closePath(),t.fill(),t.fillStyle=p.colors[2],t.beginPath(),t.moveTo(e,e),t.lineTo(0,e),t.lineTo(d,c),t.closePath(),t.fill(),t.fillStyle=p.colors[3],t.beginPath(),t.moveTo(0,e),t.lineTo(0,0),t.lineTo(d,c),t.closePath(),t.fill(),t.restore()}}s.toBlob(i=>{if(i){const u=URL.createObjectURL(i),a=document.createElement("a");a.href=u,a.download=`quilt-${Date.now()}.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(u)}})}function U(){const o={patterns:g,library:L,savedAt:new Date().toISOString()},l=JSON.stringify(o,null,2),n=new Blob([l],{type:"application/json"}),e=URL.createObjectURL(n),s=document.createElement("a");s.href=e,s.download=`quilt-design-${Date.now()}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(e)}function Q(o){var e;const l=(e=o.files)==null?void 0:e[0];if(!l)return;const n=new FileReader;n.onload=function(s){var t;try{const i=JSON.parse((t=s.target)==null?void 0:t.result);i.patterns&&i.patterns.length===48&&(g=i.patterns,q()),i.library&&(L=i.library,I()),alert("Quilt loaded successfully!")}catch(i){alert("Error loading quilt: "+i.message)}o.value=""},n.readAsText(l)}function S(o){const l=Math.floor(o/8),e=o%8,s=5-l;return e*6+s}function F(){window.innerHeight>window.innerWidth?(C=8,R=6):(C=6,R=8)}function x(o,l){const n=O(l);l.type==="solid"?(o.style.backgroundColor=n,o.style.backgroundImage="none"):(o.style.backgroundImage=n,o.style.backgroundColor="transparent",o.style.backgroundRepeat="no-repeat"),o.style.transform=`rotate(${l.rotation||0}deg)`}function q(){const o=document.getElementById("quilt");o.innerHTML="",F(),E=B();const l=window.innerHeight>window.innerWidth;g.length!==48&&H();for(let n=0;n<C*R;n++){const e=document.createElement("div");e.className="quilt-square";const s=l?n:S(n),t=g[s];x(e,t),e.style.width=`${E}px`,e.style.height=`${E}px`,e.draggable=!0,e.addEventListener("dragstart",i=>{if(v=n,e.classList.add("dragging"),i.dataTransfer){const u=document.createElement("canvas"),a=e.offsetWidth;u.width=a,u.height=a;const r=u.getContext("2d"),w=l?n:S(n),f=g[w],p=f.rotation||0;if(r.save(),r.translate(a/2,a/2),r.rotate(p*Math.PI/180),r.translate(-a/2,-a/2),f.type==="solid")r.fillStyle=f.colors[0],r.fillRect(0,0,a,a);else if(f.type==="horizontal"||f.type==="vertical"||f.type==="diagonal"){const d=a/5;for(let c=0;c<5;c++)if(r.fillStyle=f.colors[c],f.type==="horizontal")r.fillRect(0,c*d,a,d);else if(f.type==="vertical")r.fillRect(c*d,0,d,a);else if(f.type==="diagonal"){r.save(),r.translate(a/2,a/2),r.rotate(-45*Math.PI/180);const h=a*Math.sqrt(2),T=h/5;r.fillRect(-h/2+c*T,-h/2,T,h),r.restore()}}else if(f.type==="checkerboard"){const d=a/4;for(let c=0;c<4;c++)for(let h=0;h<4;h++)r.fillStyle=f.colors[(c+h)%2],r.fillRect(h*d,c*d,d,d)}else if(f.type==="quartersquare"){const d=a/2,c=a/2;r.fillStyle=f.colors[0],r.beginPath(),r.moveTo(0,0),r.lineTo(a,0),r.lineTo(d,c),r.closePath(),r.fill(),r.fillStyle=f.colors[1],r.beginPath(),r.moveTo(a,0),r.lineTo(a,a),r.lineTo(d,c),r.closePath(),r.fill(),r.fillStyle=f.colors[2],r.beginPath(),r.moveTo(a,a),r.lineTo(0,a),r.lineTo(d,c),r.closePath(),r.fill(),r.fillStyle=f.colors[3],r.beginPath(),r.moveTo(0,a),r.lineTo(0,0),r.lineTo(d,c),r.closePath(),r.fill()}r.restore();const m=new Image;m.src=u.toDataURL(),m.style.position="absolute",m.style.top="-9999px",document.body.appendChild(m),i.dataTransfer.setDragImage(m,a/2,a/2),setTimeout(()=>m.remove(),0)}}),e.addEventListener("dragend",i=>{e.classList.remove("dragging"),v=null}),e.addEventListener("dblclick",i=>{i.preventDefault(),M(n)}),e.addEventListener("dragover",i=>{i.preventDefault(),e.classList.add("drag-over")}),e.addEventListener("dragleave",i=>{e.classList.remove("drag-over")}),e.addEventListener("drop",i=>{i.preventDefault(),e.classList.remove("drag-over");const u=l?n:S(n);if(P!==null)g[u]=JSON.parse(JSON.stringify(L[P])),x(e,g[u]);else if(v!==null&&v!==n){const a=l?v:S(v);g[u]=JSON.parse(JSON.stringify(g[a])),x(e,g[u])}}),e.addEventListener("touchstart",i=>{const u=new Date().getTime(),a=u-$;if(a<300&&a>0&&k===n){i.preventDefault(),M(n),$=0,k=-1;return}$=u,k=n,v=n,e.classList.add("dragging"),N(e,i.touches[0]),i.preventDefault()}),e.addEventListener("touchmove",i=>{i.preventDefault();const u=i.touches[0];W(u);const a=document.elementFromPoint(u.clientX,u.clientY);document.querySelectorAll(".quilt-square.drag-over").forEach(r=>{r.classList.remove("drag-over")}),a&&a.classList.contains("quilt-square")&&a.classList.add("drag-over")}),e.addEventListener("touchend",i=>{i.preventDefault(),e.classList.remove("dragging"),D();const u=i.changedTouches[0],a=document.elementFromPoint(u.clientX,u.clientY);if(document.querySelectorAll(".quilt-square.drag-over").forEach(r=>{r.classList.remove("drag-over")}),a&&a.classList.contains("quilt-square")){const r=Array.from(o.children).indexOf(a);if(v!==null&&r!==-1&&v!==r){const w=l?r:S(r);if(P!==null)g[w]=JSON.parse(JSON.stringify(L[P]));else{const f=l?v:S(v);g[w]=JSON.parse(JSON.stringify(g[f]))}x(a,g[w])}}v=null,P=null}),o.appendChild(e)}}window.addEventListener("resize",q);window.addEventListener("orientationchange",q);window.updateColorPickers=z;window.addPatternToLibrary=A;window.exportQuiltAsPNG=J;window.saveQuilt=U;window.loadQuilt=Q;H();q();z();I();
