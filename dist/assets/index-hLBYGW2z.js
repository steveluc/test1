(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const t of s)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const t={};return s.integrity&&(t.integrity=s.integrity),s.referrerPolicy&&(t.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?t.credentials="include":s.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function e(s){if(s.ep)return;s.ep=!0;const t=n(s);fetch(s.href,t)}})();let k=50,$=8,R=6,g=[],v=null,L=[],P=null,y=null,E=0,C=-1;function W(o,i){y=o.cloneNode(!0),y.classList.add("drag-ghost"),y.style.width=o.offsetWidth+"px",y.style.height=o.offsetHeight+"px",y.style.left=i.clientX+"px",y.style.top=i.clientY+"px";const n=window.getComputedStyle(o).transform;n&&n!=="none"&&(y.style.transform=n+" translate(-50%, -50%)"),document.body.appendChild(y)}function H(o){y&&(y.style.left=o.clientX+"px",y.style.top=o.clientY+"px")}function N(){y&&(y.remove(),y=null)}function M(o){const n=window.innerHeight>window.innerWidth?o:S(o);g[n].rotation||(g[n].rotation=0),g[n].rotation=(g[n].rotation+90)%360,q()}function B(){const o=window.innerHeight>window.innerWidth,i=o?6:8,n=o?8:6;let e,s;o?(e=window.innerHeight-200,s=window.innerWidth-40):(e=window.innerHeight-30,s=window.innerWidth-320-40);const t=Math.floor((e-20)/n),r=Math.floor((s-20)/i);return Math.max(30,Math.min(t,r,100))}function b(){const o=Math.floor(Math.random()*360),i=60+Math.floor(Math.random()*30),n=60+Math.floor(Math.random()*20);return`hsl(${o}, ${i}%, ${n}%)`}function j(){const o=["solid","horizontal","vertical","diagonal","checkerboard","quartersquare"],i=o[Math.floor(Math.random()*o.length)];if(i==="solid")return{type:"solid",colors:[b()],rotation:0};if(i==="horizontal"||i==="vertical"||i==="diagonal"){const n=[];for(let e=0;e<5;e++)n.push(b());return{type:i,colors:n,rotation:0}}else{if(i==="checkerboard")return{type:"checkerboard",colors:[b(),b()],rotation:0};if(i==="quartersquare")return{type:"quartersquare",colors:[b(),b(),b(),b()],rotation:0}}return{type:"solid",colors:[b()],rotation:0}}function D(){g=[];for(let o=0;o<48;o++)g.push(j())}function O(o){if(o.type==="solid")return o.colors[0];if(o.type==="horizontal"){const n=[];for(let e=0;e<5;e++){const s=e*20,t=(e+1)*20;n.push(`${o.colors[e]} ${s}%`),n.push(`${o.colors[e]} ${t}%`)}return`linear-gradient(to bottom, ${n.join(", ")})`}else if(o.type==="vertical"){const n=[];for(let e=0;e<5;e++){const s=e*20,t=(e+1)*20;n.push(`${o.colors[e]} ${s}%`),n.push(`${o.colors[e]} ${t}%`)}return`linear-gradient(to right, ${n.join(", ")})`}else if(o.type==="diagonal"){const n=[];for(let e=0;e<5;e++){const s=e*20,t=(e+1)*20;n.push(`${o.colors[e]} ${s}%`),n.push(`${o.colors[e]} ${t}%`)}return`linear-gradient(45deg, ${n.join(", ")})`}else if(o.type==="checkerboard"){const i=o.colors[0].replace("#","%23"),n=o.colors[1].replace("#","%23");let e="";for(let s=0;s<4;s++)for(let t=0;t<4;t++){const r=(s+t)%2===0?i:n;e+=`<rect x='${t*25}' y='${s*25}' width='25' height='25' fill='${r}'/>`}return`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>${e}</svg>")`}else if(o.type==="quartersquare"){const i=o.colors[0].replace("#","%23"),n=o.colors[1].replace("#","%23"),e=o.colors[2].replace("#","%23"),s=o.colors[3].replace("#","%23");return`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><polygon points='0,0 100,0 50,50' fill='${i}'/><polygon points='100,0 100,100 50,50' fill='${n}'/><polygon points='100,100 0,100 50,50' fill='${e}'/><polygon points='0,100 0,0 50,50' fill='${s}'/></svg>")`}return""}function z(){const i=document.getElementById("designerPatternType").value,n=document.getElementById("colorStripePicker");n.innerHTML="";let e=1,s=["#ff6b9d"];i==="solid"?(e=1,s=["#ff6b9d"]):i==="horizontal"||i==="vertical"||i==="diagonal"?(e=5,s=["#ff6b9d","#764ba2","#667eea","#f093fb","#4facfe"]):i==="checkerboard"?(e=2,s=["#ff6b9d","#667eea"]):i==="quartersquare"&&(e=4,s=["#ff6b9d","#764ba2","#667eea","#f093fb"]);for(let t=0;t<e;t++){const r=document.createElement("input");r.type="color",r.value=s[t],n.appendChild(r)}}function A(){const i=document.getElementById("designerPatternType").value,n=document.querySelectorAll('#colorStripePicker input[type="color"]'),e=Array.from(n).map(t=>t.value),s={type:i,colors:e,rotation:0};L.push(s),I()}function I(){const o=document.getElementById("libraryItems");if(o.innerHTML="",L.length===0){o.innerHTML='<p style="color: #999; font-style: italic;">No patterns yet. Design one above to get started!</p>';return}L.forEach((i,n)=>{const e=document.createElement("div");e.className="library-item",e.draggable=!0;const s=O(i);i.type==="solid"?(e.style.backgroundColor=s,e.style.backgroundImage="none"):(e.style.backgroundImage=s,e.style.backgroundColor="transparent",e.style.backgroundRepeat="no-repeat"),e.addEventListener("dragstart",r=>{if(P=n,e.classList.add("dragging"),r.dataTransfer){const c=e.cloneNode(!0);c.style.position="absolute",c.style.top="-1000px",c.style.left="0",c.style.width=e.offsetWidth+"px",c.style.height=e.offsetHeight+"px",c.style.backgroundImage=e.style.backgroundImage,c.style.backgroundColor=e.style.backgroundColor,c.style.backgroundRepeat=e.style.backgroundRepeat,c.style.backgroundSize="100% 100%",c.style.opacity="1",document.body.appendChild(c),r.dataTransfer.setDragImage(c,e.offsetWidth/2,e.offsetHeight/2),setTimeout(()=>c.remove(),0)}}),e.addEventListener("dragend",r=>{e.classList.remove("dragging"),P=null}),e.addEventListener("touchstart",r=>{P=n,v=null,e.classList.add("dragging"),W(e,r.touches[0]),r.stopPropagation()}),e.addEventListener("touchmove",r=>{r.preventDefault();const c=r.touches[0];H(c);const a=document.elementFromPoint(c.clientX,c.clientY);document.querySelectorAll(".quilt-square.drag-over").forEach(l=>{l.classList.remove("drag-over")}),a&&a.classList.contains("quilt-square")&&a.classList.add("drag-over")}),e.addEventListener("touchend",r=>{r.preventDefault(),e.classList.remove("dragging"),N();const c=r.changedTouches[0],a=document.elementFromPoint(c.clientX,c.clientY);if(document.querySelectorAll(".quilt-square.drag-over").forEach(l=>{l.classList.remove("drag-over")}),a&&a.classList.contains("quilt-square")){const l=document.getElementById("quilt"),w=Array.from(l.children).indexOf(a),f=window.innerHeight>window.innerWidth;if(w!==-1){const p=f?w:S(w);g[p]=JSON.parse(JSON.stringify(L[n]));const m=g[p],u=O(m),d=a;m.type==="solid"?(d.style.backgroundColor=u,d.style.backgroundImage="none"):(d.style.backgroundImage=u,d.style.backgroundColor="transparent",d.style.backgroundRepeat="no-repeat"),d.style.transform=`rotate(${m.rotation||0}deg)`}}P=null});const t=document.createElement("button");t.className="delete-btn",t.textContent="Ã—",t.onclick=r=>{r.stopPropagation(),L.splice(n,1),I()},e.appendChild(t),o.appendChild(e)})}function J(){const o=window.innerHeight>window.innerWidth,i=o?6:8,n=o?8:6,e=100,s=document.createElement("canvas");s.width=i*e,s.height=n*e;const t=s.getContext("2d");for(let r=0;r<n*i;r++){const c=Math.floor(r/i),l=r%i*e,w=c*e,f=o?r:S(r),p=g[f],m=p.rotation||0;if(t.save(),m!==0?(t.translate(l+e/2,w+e/2),t.rotate(m*Math.PI/180),t.translate(-e/2,-e/2)):t.translate(l,w),p.type==="solid")t.fillStyle=p.colors[0],t.fillRect(0,0,e,e),t.restore();else if(p.type==="horizontal"){const u=e/5;for(let d=0;d<5;d++)t.fillStyle=p.colors[d],t.fillRect(0,d*u,e,u);t.restore()}else if(p.type==="vertical"){const u=e/5;for(let d=0;d<5;d++)t.fillStyle=p.colors[d],t.fillRect(d*u,0,u,e);t.restore()}else if(p.type==="diagonal"){t.beginPath(),t.rect(0,0,e,e),t.clip(),t.translate(e/2,e/2),t.rotate(-45*Math.PI/180);const u=e*Math.sqrt(2),d=u/5;for(let h=0;h<5;h++)t.fillStyle=p.colors[h],t.fillRect(-u/2+h*d,-u/2,d,u);t.restore()}else if(p.type==="checkerboard"){const u=e/4;for(let d=0;d<4;d++)for(let h=0;h<4;h++){const T=(d+h)%2;t.fillStyle=p.colors[T],t.fillRect(h*u,d*u,u,u)}t.restore()}else if(p.type==="quartersquare"){const u=e/2,d=e/2;t.fillStyle=p.colors[0],t.beginPath(),t.moveTo(0,0),t.lineTo(e,0),t.lineTo(u,d),t.closePath(),t.fill(),t.fillStyle=p.colors[1],t.beginPath(),t.moveTo(e,0),t.lineTo(e,e),t.lineTo(u,d),t.closePath(),t.fill(),t.fillStyle=p.colors[2],t.beginPath(),t.moveTo(e,e),t.lineTo(0,e),t.lineTo(u,d),t.closePath(),t.fill(),t.fillStyle=p.colors[3],t.beginPath(),t.moveTo(0,e),t.lineTo(0,0),t.lineTo(u,d),t.closePath(),t.fill(),t.restore()}}s.toBlob(r=>{if(r){const c=URL.createObjectURL(r),a=document.createElement("a");a.href=c,a.download=`quilt-${Date.now()}.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(c)}})}function U(){const o={patterns:g,library:L,savedAt:new Date().toISOString()},i=JSON.stringify(o,null,2),n=new Blob([i],{type:"application/json"}),e=URL.createObjectURL(n),s=document.createElement("a");s.href=e,s.download=`quilt-design-${Date.now()}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(e)}function Q(o){var e;const i=(e=o.files)==null?void 0:e[0];if(!i)return;const n=new FileReader;n.onload=function(s){var t;try{const r=JSON.parse((t=s.target)==null?void 0:t.result);r.patterns&&r.patterns.length===48&&(g=r.patterns,q()),r.library&&(L=r.library,I()),alert("Quilt loaded successfully!")}catch(r){alert("Error loading quilt: "+r.message)}o.value=""},n.readAsText(i)}function S(o){const i=Math.floor(o/8),e=o%8,s=5-i;return e*6+s}function F(){window.innerHeight>window.innerWidth?($=8,R=6):($=6,R=8)}function x(o,i){const n=O(i);i.type==="solid"?(o.style.backgroundColor=n,o.style.backgroundImage="none"):(o.style.backgroundImage=n,o.style.backgroundColor="transparent",o.style.backgroundRepeat="no-repeat"),o.style.transform=`rotate(${i.rotation||0}deg)`}function q(){const o=document.getElementById("quilt");o.innerHTML="",F(),k=B();const i=window.innerHeight>window.innerWidth;g.length!==48&&D();for(let n=0;n<$*R;n++){const e=document.createElement("div");e.className="quilt-square";const s=i?n:S(n),t=g[s];x(e,t),e.style.width=`${k}px`,e.style.height=`${k}px`,e.draggable=!0,e.addEventListener("dragstart",r=>{if(v=n,e.classList.add("dragging"),r.dataTransfer){const c=document.createElement("canvas"),a=e.offsetWidth;c.width=a,c.height=a;const l=c.getContext("2d"),w=i?n:S(n),f=g[w],p=f.rotation||0;if(l.save(),l.translate(a/2,a/2),l.rotate(p*Math.PI/180),l.translate(-a/2,-a/2),f.type==="solid")l.fillStyle=f.colors[0],l.fillRect(0,0,a,a);else if(f.type==="horizontal"||f.type==="vertical"||f.type==="diagonal"){const u=a/5;for(let d=0;d<5;d++)if(l.fillStyle=f.colors[d],f.type==="horizontal")l.fillRect(0,d*u,a,u);else if(f.type==="vertical")l.fillRect(d*u,0,u,a);else if(f.type==="diagonal"){l.save(),l.translate(a/2,a/2),l.rotate(-45*Math.PI/180);const h=a*Math.sqrt(2),T=h/5;l.fillRect(-h/2+d*T,-h/2,T,h),l.restore()}}else if(f.type==="checkerboard"){const u=a/4;for(let d=0;d<4;d++)for(let h=0;h<4;h++)l.fillStyle=f.colors[(d+h)%2],l.fillRect(h*u,d*u,u,u)}else if(f.type==="quartersquare"){const u=a/2,d=a/2;l.fillStyle=f.colors[0],l.beginPath(),l.moveTo(0,0),l.lineTo(a,0),l.lineTo(u,d),l.closePath(),l.fill(),l.fillStyle=f.colors[1],l.beginPath(),l.moveTo(a,0),l.lineTo(a,a),l.lineTo(u,d),l.closePath(),l.fill(),l.fillStyle=f.colors[2],l.beginPath(),l.moveTo(a,a),l.lineTo(0,a),l.lineTo(u,d),l.closePath(),l.fill(),l.fillStyle=f.colors[3],l.beginPath(),l.moveTo(0,a),l.lineTo(0,0),l.lineTo(u,d),l.closePath(),l.fill()}l.restore();const m=new Image;m.src=c.toDataURL(),m.style.position="absolute",m.style.top="-9999px",document.body.appendChild(m),r.dataTransfer.setDragImage(m,a/2,a/2),setTimeout(()=>m.remove(),0)}}),e.addEventListener("dragend",r=>{e.classList.remove("dragging"),v=null}),e.addEventListener("dblclick",r=>{r.preventDefault(),M(n)}),e.addEventListener("dragover",r=>{r.preventDefault(),e.classList.add("drag-over")}),e.addEventListener("dragleave",r=>{e.classList.remove("drag-over")}),e.addEventListener("drop",r=>{r.preventDefault(),e.classList.remove("drag-over");const c=i?n:S(n);if(P!==null)g[c]=JSON.parse(JSON.stringify(L[P])),x(e,g[c]);else if(v!==null&&v!==n){const a=i?v:S(v);g[c]=JSON.parse(JSON.stringify(g[a])),x(e,g[c])}}),e.addEventListener("touchstart",r=>{const c=new Date().getTime(),a=c-E;if(a<300&&a>0&&C===n){r.preventDefault(),M(n),E=0,C=-1;return}E=c,C=n,v=n,e.classList.add("dragging"),W(e,r.touches[0]),r.preventDefault()}),e.addEventListener("touchmove",r=>{r.preventDefault();const c=r.touches[0];H(c);const a=document.elementFromPoint(c.clientX,c.clientY);document.querySelectorAll(".quilt-square.drag-over").forEach(l=>{l.classList.remove("drag-over")}),a&&a.classList.contains("quilt-square")&&a.classList.add("drag-over")}),e.addEventListener("touchend",r=>{r.preventDefault(),e.classList.remove("dragging"),N();const c=r.changedTouches[0],a=document.elementFromPoint(c.clientX,c.clientY);if(document.querySelectorAll(".quilt-square.drag-over").forEach(l=>{l.classList.remove("drag-over")}),a&&a.classList.contains("quilt-square")){const l=Array.from(o.children).indexOf(a);if(v!==null&&l!==-1&&v!==l){const w=i?l:S(l);if(P!==null)g[w]=JSON.parse(JSON.stringify(L[P]));else{const f=i?v:S(v);g[w]=JSON.parse(JSON.stringify(g[f]))}x(a,g[w])}}v=null,P=null}),o.appendChild(e)}}window.addEventListener("resize",q);window.addEventListener("orientationchange",q);window.updateColorPickers=z;window.addPatternToLibrary=A;window.exportQuiltAsPNG=J;window.saveQuilt=U;window.loadQuilt=Q;D();q();z();I();
