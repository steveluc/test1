(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const t of i)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&e(n)}).observe(document,{childList:!0,subtree:!0});function r(i){const t={};return i.integrity&&(t.integrity=i.integrity),i.referrerPolicy&&(t.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?t.credentials="include":i.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function e(i){if(i.ep)return;i.ep=!0;const t=r(i);fetch(i.href,t)}})();let I=50,C=8,k=6,u=[],h=null,b=[],w=null,p=null,E=0,$=-1;function W(o,s){p=o.cloneNode(!0),p.classList.add("drag-ghost"),p.style.width=o.offsetWidth+"px",p.style.height=o.offsetHeight+"px",p.style.left=s.clientX+"px",p.style.top=s.clientY+"px";const r=window.getComputedStyle(o).transform;r&&r!=="none"&&(p.style.transform=r+" translate(-50%, -50%)"),document.body.appendChild(p)}function N(o){p&&(p.style.left=o.clientX+"px",p.style.top=o.clientY+"px")}function M(){p&&(p.remove(),p=null)}function H(o){const r=window.innerHeight>window.innerWidth?o:L(o);u[r].rotation||(u[r].rotation=0),u[r].rotation=(u[r].rotation+90)%360,P()}function j(){const o=window.innerHeight>window.innerWidth,s=o?6:8,r=o?8:6;let e,i;o?(e=window.innerHeight-200,i=window.innerWidth-40):(e=window.innerHeight-30,i=window.innerWidth-320-40);const t=Math.floor((e-20)/r),n=Math.floor((i-20)/s);return Math.max(30,Math.min(t,n,100))}function v(){const o=Math.floor(Math.random()*360),s=60+Math.floor(Math.random()*30),r=60+Math.floor(Math.random()*20);return`hsl(${o}, ${s}%, ${r}%)`}function z(){const o=["solid","horizontal","vertical","diagonal","checkerboard","quartersquare"],s=o[Math.floor(Math.random()*o.length)];if(s==="solid")return{type:"solid",colors:[v()],rotation:0};if(s==="horizontal"||s==="vertical"||s==="diagonal"){const r=[];for(let e=0;e<5;e++)r.push(v());return{type:s,colors:r,rotation:0}}else{if(s==="checkerboard")return{type:"checkerboard",colors:[v(),v()],rotation:0};if(s==="quartersquare")return{type:"quartersquare",colors:[v(),v(),v(),v()],rotation:0}}return{type:"solid",colors:[v()],rotation:0}}function R(){u=[];for(let o=0;o<48;o++)u.push(z())}function O(o){if(o.type==="solid")return o.colors[0];if(o.type==="horizontal"){const r=[];for(let e=0;e<5;e++){const i=e*20,t=(e+1)*20;r.push(`${o.colors[e]} ${i}%`),r.push(`${o.colors[e]} ${t}%`)}return`linear-gradient(to bottom, ${r.join(", ")})`}else if(o.type==="vertical"){const r=[];for(let e=0;e<5;e++){const i=e*20,t=(e+1)*20;r.push(`${o.colors[e]} ${i}%`),r.push(`${o.colors[e]} ${t}%`)}return`linear-gradient(to right, ${r.join(", ")})`}else if(o.type==="diagonal"){const r=[];for(let e=0;e<5;e++){const i=e*20,t=(e+1)*20;r.push(`${o.colors[e]} ${i}%`),r.push(`${o.colors[e]} ${t}%`)}return`linear-gradient(45deg, ${r.join(", ")})`}else if(o.type==="checkerboard"){const s=o.colors[0].replace("#","%23"),r=o.colors[1].replace("#","%23");let e="";for(let i=0;i<4;i++)for(let t=0;t<4;t++){const n=(i+t)%2===0?s:r;e+=`<rect x='${t*25}' y='${i*25}' width='25' height='25' fill='${n}'/>`}return`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>${e}</svg>")`}else if(o.type==="quartersquare"){const s=o.colors[0].replace("#","%23"),r=o.colors[1].replace("#","%23"),e=o.colors[2].replace("#","%23"),i=o.colors[3].replace("#","%23");return`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><polygon points='0,0 100,0 50,50' fill='${s}'/><polygon points='100,0 100,100 50,50' fill='${r}'/><polygon points='100,100 0,100 50,50' fill='${e}'/><polygon points='0,100 0,0 50,50' fill='${i}'/></svg>")`}return""}function D(){const s=document.getElementById("designerPatternType").value,r=document.getElementById("colorStripePicker");r.innerHTML="";let e=1,i=["#ff6b9d"];s==="solid"?(e=1,i=["#ff6b9d"]):s==="horizontal"||s==="vertical"||s==="diagonal"?(e=5,i=["#ff6b9d","#764ba2","#667eea","#f093fb","#4facfe"]):s==="checkerboard"?(e=2,i=["#ff6b9d","#667eea"]):s==="quartersquare"&&(e=4,i=["#ff6b9d","#764ba2","#667eea","#f093fb"]);for(let t=0;t<e;t++){const n=document.createElement("input");n.type="color",n.value=i[t],r.appendChild(n)}}function A(){const s=document.getElementById("designerPatternType").value,r=document.querySelectorAll('#colorStripePicker input[type="color"]'),e=Array.from(r).map(t=>t.value),i={type:s,colors:e,rotation:0};b.push(i),T()}function T(){const o=document.getElementById("libraryItems");if(o.innerHTML="",b.length===0){o.innerHTML='<p style="color: #999; font-style: italic;">No patterns yet. Design one above to get started!</p>';return}b.forEach((s,r)=>{const e=document.createElement("div");e.className="library-item",e.draggable=!0;const i=O(s);s.type==="solid"?(e.style.backgroundColor=i,e.style.backgroundImage="none"):(e.style.backgroundImage=i,e.style.backgroundColor="transparent",e.style.backgroundRepeat="no-repeat"),e.addEventListener("dragstart",n=>{if(w=r,e.classList.add("dragging"),n.dataTransfer){const l=e.cloneNode(!0);l.style.position="absolute",l.style.top="-1000px",l.style.width=e.offsetWidth+"px",l.style.height=e.offsetHeight+"px",document.body.appendChild(l),n.dataTransfer.setDragImage(l,e.offsetWidth/2,e.offsetHeight/2),setTimeout(()=>l.remove(),0)}}),e.addEventListener("dragend",n=>{e.classList.remove("dragging"),w=null}),e.addEventListener("touchstart",n=>{w=r,h=null,e.classList.add("dragging"),W(e,n.touches[0]),n.stopPropagation()}),e.addEventListener("touchmove",n=>{n.preventDefault();const l=n.touches[0];N(l);const a=document.elementFromPoint(l.clientX,l.clientY);document.querySelectorAll(".quilt-square.drag-over").forEach(g=>{g.classList.remove("drag-over")}),a&&a.classList.contains("quilt-square")&&a.classList.add("drag-over")}),e.addEventListener("touchend",n=>{n.preventDefault(),e.classList.remove("dragging"),M();const l=n.changedTouches[0],a=document.elementFromPoint(l.clientX,l.clientY);if(document.querySelectorAll(".quilt-square.drag-over").forEach(g=>{g.classList.remove("drag-over")}),a&&a.classList.contains("quilt-square")){const g=document.getElementById("quilt"),y=Array.from(g.children).indexOf(a),S=window.innerHeight>window.innerWidth;if(y!==-1){const f=S?y:L(y);u[f]=JSON.parse(JSON.stringify(b[r]));const q=u[f],d=O(q),c=a;q.type==="solid"?(c.style.backgroundColor=d,c.style.backgroundImage="none"):(c.style.backgroundImage=d,c.style.backgroundColor="transparent",c.style.backgroundRepeat="no-repeat"),c.style.transform=`rotate(${q.rotation||0}deg)`}}w=null});const t=document.createElement("button");t.className="delete-btn",t.textContent="Ã—",t.onclick=n=>{n.stopPropagation(),b.splice(r,1),T()},e.appendChild(t),o.appendChild(e)})}function J(){const o=window.innerHeight>window.innerWidth,s=o?6:8,r=o?8:6,e=100,i=document.createElement("canvas");i.width=s*e,i.height=r*e;const t=i.getContext("2d");for(let n=0;n<r*s;n++){const l=Math.floor(n/s),g=n%s*e,y=l*e,S=o?n:L(n),f=u[S],q=f.rotation||0;if(t.save(),q!==0?(t.translate(g+e/2,y+e/2),t.rotate(q*Math.PI/180),t.translate(-e/2,-e/2)):t.translate(g,y),f.type==="solid")t.fillStyle=f.colors[0],t.fillRect(0,0,e,e),t.restore();else if(f.type==="horizontal"){const d=e/5;for(let c=0;c<5;c++)t.fillStyle=f.colors[c],t.fillRect(0,c*d,e,d);t.restore()}else if(f.type==="vertical"){const d=e/5;for(let c=0;c<5;c++)t.fillStyle=f.colors[c],t.fillRect(c*d,0,d,e);t.restore()}else if(f.type==="diagonal"){t.beginPath(),t.rect(0,0,e,e),t.clip(),t.translate(e/2,e/2),t.rotate(-45*Math.PI/180);const d=e*Math.sqrt(2),c=d/5;for(let m=0;m<5;m++)t.fillStyle=f.colors[m],t.fillRect(-d/2+m*c,-d/2,c,d);t.restore()}else if(f.type==="checkerboard"){const d=e/4;for(let c=0;c<4;c++)for(let m=0;m<4;m++){const B=(c+m)%2;t.fillStyle=f.colors[B],t.fillRect(m*d,c*d,d,d)}t.restore()}else if(f.type==="quartersquare"){const d=e/2,c=e/2;t.fillStyle=f.colors[0],t.beginPath(),t.moveTo(0,0),t.lineTo(e,0),t.lineTo(d,c),t.closePath(),t.fill(),t.fillStyle=f.colors[1],t.beginPath(),t.moveTo(e,0),t.lineTo(e,e),t.lineTo(d,c),t.closePath(),t.fill(),t.fillStyle=f.colors[2],t.beginPath(),t.moveTo(e,e),t.lineTo(0,e),t.lineTo(d,c),t.closePath(),t.fill(),t.fillStyle=f.colors[3],t.beginPath(),t.moveTo(0,e),t.lineTo(0,0),t.lineTo(d,c),t.closePath(),t.fill(),t.restore()}}i.toBlob(n=>{if(n){const l=URL.createObjectURL(n),a=document.createElement("a");a.href=l,a.download=`quilt-${Date.now()}.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(l)}})}function Q(){const o={patterns:u,library:b,savedAt:new Date().toISOString()},s=JSON.stringify(o,null,2),r=new Blob([s],{type:"application/json"}),e=URL.createObjectURL(r),i=document.createElement("a");i.href=e,i.download=`quilt-design-${Date.now()}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(e)}function U(o){var e;const s=(e=o.files)==null?void 0:e[0];if(!s)return;const r=new FileReader;r.onload=function(i){var t;try{const n=JSON.parse((t=i.target)==null?void 0:t.result);n.patterns&&n.patterns.length===48&&(u=n.patterns,P()),n.library&&(b=n.library,T()),alert("Quilt loaded successfully!")}catch(n){alert("Error loading quilt: "+n.message)}o.value=""},r.readAsText(s)}function L(o){const s=Math.floor(o/8),e=o%8,i=5-s;return e*6+i}function F(){window.innerHeight>window.innerWidth?(C=8,k=6):(C=6,k=8)}function x(o,s){const r=O(s);s.type==="solid"?(o.style.backgroundColor=r,o.style.backgroundImage="none"):(o.style.backgroundImage=r,o.style.backgroundColor="transparent",o.style.backgroundRepeat="no-repeat"),o.style.transform=`rotate(${s.rotation||0}deg)`}function P(){const o=document.getElementById("quilt");o.innerHTML="",F(),I=j();const s=window.innerHeight>window.innerWidth;u.length!==48&&R();for(let r=0;r<C*k;r++){const e=document.createElement("div");e.className="quilt-square";const i=s?r:L(r),t=u[i];x(e,t),e.style.width=`${I}px`,e.style.height=`${I}px`,e.draggable=!0,e.addEventListener("dragstart",n=>{if(h=r,e.classList.add("dragging"),n.dataTransfer){const l=e.cloneNode(!0);l.style.position="absolute",l.style.top="-1000px",l.style.width=e.offsetWidth+"px",l.style.height=e.offsetHeight+"px",l.style.transform=e.style.transform,document.body.appendChild(l),n.dataTransfer.setDragImage(l,e.offsetWidth/2,e.offsetHeight/2),setTimeout(()=>l.remove(),0)}}),e.addEventListener("dragend",n=>{e.classList.remove("dragging"),h=null}),e.addEventListener("dblclick",n=>{n.preventDefault(),H(r)}),e.addEventListener("dragover",n=>{n.preventDefault(),e.classList.add("drag-over")}),e.addEventListener("dragleave",n=>{e.classList.remove("drag-over")}),e.addEventListener("drop",n=>{n.preventDefault(),e.classList.remove("drag-over");const l=s?r:L(r);if(w!==null)u[l]=JSON.parse(JSON.stringify(b[w])),x(e,u[l]);else if(h!==null&&h!==r){const a=s?h:L(h);u[l]=JSON.parse(JSON.stringify(u[a])),x(e,u[l])}}),e.addEventListener("touchstart",n=>{const l=new Date().getTime(),a=l-E;if(a<300&&a>0&&$===r){n.preventDefault(),H(r),E=0,$=-1;return}E=l,$=r,h=r,e.classList.add("dragging"),W(e,n.touches[0]),n.preventDefault()}),e.addEventListener("touchmove",n=>{n.preventDefault();const l=n.touches[0];N(l);const a=document.elementFromPoint(l.clientX,l.clientY);document.querySelectorAll(".quilt-square.drag-over").forEach(g=>{g.classList.remove("drag-over")}),a&&a.classList.contains("quilt-square")&&a.classList.add("drag-over")}),e.addEventListener("touchend",n=>{n.preventDefault(),e.classList.remove("dragging"),M();const l=n.changedTouches[0],a=document.elementFromPoint(l.clientX,l.clientY);if(document.querySelectorAll(".quilt-square.drag-over").forEach(g=>{g.classList.remove("drag-over")}),a&&a.classList.contains("quilt-square")){const g=Array.from(o.children).indexOf(a);if(h!==null&&g!==-1&&h!==g){const y=s?g:L(g);if(w!==null)u[y]=JSON.parse(JSON.stringify(b[w]));else{const S=s?h:L(h);u[y]=JSON.parse(JSON.stringify(u[S]))}x(a,u[y])}}h=null,w=null}),o.appendChild(e)}}window.addEventListener("resize",P);window.addEventListener("orientationchange",P);window.updateColorPickers=D;window.addPatternToLibrary=A;window.exportQuiltAsPNG=J;window.saveQuilt=Q;window.loadQuilt=U;R();P();D();T();
